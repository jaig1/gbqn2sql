<?xml version="1.0" encoding="UTF-8"?>
<svg width="1400" height="900" viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .class-box { fill: #dbeafe; stroke: #1e40af; stroke-width: 2; }
      .class-title { fill: #1e3a8a; font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; }
      .property-text { fill: #374151; font-family: 'Courier New', monospace; font-size: 11px; }
      .namespace-label { fill: #6b7280; font-family: Arial, sans-serif; font-size: 10px; font-style: italic; }
      .relation-line { stroke: #6b7280; stroke-width: 2; fill: none; }
      .inheritance-line { stroke: #dc2626; stroke-width: 2; fill: none; stroke-dasharray: 5,5; }
      .relation-label { fill: #059669; font-family: Arial, sans-serif; font-size: 11px; font-weight: bold; }
      .datatype-box { fill: #fef3c7; stroke: #d97706; stroke-width: 2; }
      .business-box { fill: #ddd6fe; stroke: #6b21a8; stroke-width: 2; }
      .validation-box { fill: #fce7f3; stroke: #be185d; stroke-width: 2; }
      .instance-box { fill: #f0fdf4; stroke: #16a34a; stroke-width: 2; stroke-dasharray: 5,5; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#6b7280" />
    </marker>
    <marker id="inheritance-arrow" markerWidth="12" markerHeight="12" refX="9" refY="6" orient="auto">
      <polygon points="0 0, 12 6, 0 12" fill="none" stroke="#dc2626" stroke-width="2" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" style="font-family: Arial; font-size: 22px; font-weight: bold; fill: #111827;">
    SQL Structure ↔ Business Semantics Integration
  </text>
  <text x="700" y="55" text-anchor="middle" style="font-family: Arial; font-size: 12px; fill: #6b7280;">
    Business Layer (Top) → SQL Layer (Bottom) - Clean Separation
  </text>

  <!-- ============ BUSINESS NAMESPACE (TOP LAYER) ============ -->

  <!-- Business Rule Class -->
  <g id="rule-class">
    <rect x="50" y="100" width="240" height="140" class="business-box" rx="5"/>
    <text x="170" y="120" text-anchor="middle" class="class-title">business:Rule</text>
    <text x="60" y="138" class="namespace-label">&lt;&lt;Class&gt;&gt;</text>
    <line x1="50" y1="145" x2="290" y2="145" stroke="#6b21a8" stroke-width="1"/>
    <text x="60" y="162" class="property-text">+ category: string</text>
    <text x="60" y="178" class="property-text">+ logic: string</text>
    <text x="60" y="194" class="property-text">+ appliesTo: Table [1]</text>
    <text x="60" y="210" class="property-text">+ requiresSubquery: boolean</text>
  </g>

  <!-- Business Concept Class -->
  <g id="concept-class">
    <rect x="330" y="100" width="240" height="110" class="business-box" rx="5"/>
    <text x="450" y="120" text-anchor="middle" class="class-title">business:Concept</text>
    <text x="340" y="138" class="namespace-label">&lt;&lt;Class&gt;&gt;</text>
    <line x1="330" y1="145" x2="570" y2="145" stroke="#6b21a8" stroke-width="1"/>
    <text x="340" y="162" class="property-text">+ relatedTerm: string [*]</text>
    <text x="340" y="178" class="property-text">+ domain: string</text>
  </g>

  <!-- TableSynonyms Class -->
  <g id="table-synonyms-class">
    <rect x="630" y="100" width="240" height="110" class="business-box" rx="5"/>
    <text x="750" y="120" text-anchor="middle" class="class-title">business:TableSynonyms</text>
    <text x="640" y="138" class="namespace-label">&lt;&lt;Class&gt;&gt;</text>
    <line x1="630" y1="145" x2="870" y2="145" stroke="#6b21a8" stroke-width="1"/>
    <text x="640" y="162" class="property-text">+ mapsToTable: Table [1]</text>
    <text x="640" y="178" class="property-text">+ hasAlias: Alias [1..*]</text>
  </g>

  <!-- Alias Class -->
  <g id="alias-class">
    <rect x="950" y="100" width="240" height="90" class="business-box" rx="5"/>
    <text x="1070" y="120" text-anchor="middle" class="class-title">business:Alias</text>
    <text x="960" y="138" class="namespace-label">&lt;&lt;Class&gt;&gt;</text>
    <line x1="950" y1="145" x2="1190" y2="145" stroke="#6b21a8" stroke-width="1"/>
    <text x="960" y="162" class="property-text">+ label: string</text>
    <text x="960" y="178" class="property-text">+ aliasFor: Resource [1]</text>
  </g>

  <!-- CompositeRule Class -->
  <g id="composite-rule-class">
    <rect x="330" y="260" width="240" height="110" class="business-box" rx="5"/>
    <text x="450" y="280" text-anchor="middle" class="class-title">business:CompositeRule</text>
    <text x="340" y="298" class="namespace-label">&lt;&lt;Class&gt;&gt;</text>
    <line x1="330" y1="305" x2="570" y2="305" stroke="#6b21a8" stroke-width="1"/>
    <text x="340" y="322" class="property-text">+ isComposite: true</text>
    <text x="340" y="338" class="property-text">+ usesRule: Rule [1..*]</text>
  </g>

  <!-- Business relationships -->
  <path d="M 750 210 L 750 240 L 750 270" class="relation-line" marker-end="url(#arrow)" stroke="#059669" stroke-width="2"/>
  <text x="760" y="240" class="relation-label" style="fill: #6b21a8; font-size: 11px;">hasAlias</text>

  <path d="M 290 170 L 330 280" class="inheritance-line" marker-end="url(#inheritance-arrow)"/>
  <text x="300" y="225" style="fill: #dc2626; font-family: Arial; font-size: 11px;">inherits</text>

  <!-- ============ SQL NAMESPACE (BOTTOM LAYER) ============ -->
  
  <!-- Database Class -->
  <g id="database-class">
    <rect x="50" y="450" width="200" height="110" class="class-box" rx="5"/>
    <text x="150" y="470" text-anchor="middle" class="class-title">sql:Database</text>
    <text x="60" y="488" class="namespace-label">&lt;&lt;Class&gt;&gt;</text>
    <line x1="50" y1="495" x2="250" y2="495" stroke="#1e40af" stroke-width="1"/>
    <text x="60" y="512" class="property-text">+ identifier: string</text>
    <text x="60" y="528" class="property-text">+ platform: string</text>
    <text x="60" y="544" class="property-text">+ hasSchema: Schema [1..*]</text>
  </g>

  <!-- Schema Class -->
  <g id="schema-class">
    <rect x="330" y="450" width="220" height="140" class="class-box" rx="5"/>
    <text x="440" y="470" text-anchor="middle" class="class-title">sql:Schema</text>
    <text x="340" y="488" class="namespace-label">&lt;&lt;Class&gt;&gt;</text>
    <line x1="330" y1="495" x2="550" y2="495" stroke="#1e40af" stroke-width="1"/>
    <text x="340" y="512" class="property-text">+ identifier: string</text>
    <text x="340" y="528" class="property-text">+ domain: string</text>
    <text x="340" y="544" class="property-text">+ purpose: string</text>
    <text x="340" y="560" class="property-text">+ location: string</text>
    <text x="340" y="576" class="property-text">+ inDatabase: Database [1]</text>
  </g>

  <!-- Table Class -->
  <g id="table-class">
    <rect x="630" y="450" width="240" height="160" class="class-box" rx="5"/>
    <text x="750" y="470" text-anchor="middle" class="class-title">sql:Table</text>
    <text x="640" y="488" class="namespace-label">&lt;&lt;Class&gt;&gt;</text>
    <line x1="630" y1="495" x2="870" y2="495" stroke="#1e40af" stroke-width="1"/>
    <text x="640" y="512" class="property-text">+ identifier: string</text>
    <text x="640" y="528" class="property-text">+ rowCount: integer</text>
    <text x="640" y="544" class="property-text">+ sizeBytes: integer</text>
    <text x="640" y="560" class="property-text">+ qualityScore: float</text>
    <text x="640" y="576" class="property-text">+ inSchema: Schema [1]</text>
    <text x="640" y="592" class="property-text">+ hasColumn: Column [1..*]</text>
  </g>

  <!-- Column Class -->
  <g id="column-class">
    <rect x="950" y="450" width="240" height="150" class="class-box" rx="5"/>
    <text x="1070" y="470" text-anchor="middle" class="class-title">sql:Column</text>
    <text x="960" y="488" class="namespace-label">&lt;&lt;Class&gt;&gt;</text>
    <line x1="950" y1="495" x2="1190" y2="495" stroke="#1e40af" stroke-width="1"/>
    <text x="960" y="512" class="property-text">+ identifier: string</text>
    <text x="960" y="528" class="property-text">+ dataType: string</text>
    <text x="960" y="544" class="property-text">+ primaryKey: boolean</text>
    <text x="960" y="560" class="property-text">+ nullable: boolean</text>
    <text x="960" y="576" class="property-text">+ inTable: Table [1]</text>
  </g>

  <!-- ForeignKey Class -->
  <g id="fk-class">
    <rect x="630" y="650" width="240" height="140" class="class-box" rx="5"/>
    <text x="750" y="670" text-anchor="middle" class="class-title">sql:ForeignKey</text>
    <text x="640" y="688" class="namespace-label">&lt;&lt;Class&gt;&gt;</text>
    <line x1="630" y1="695" x2="870" y2="695" stroke="#1e40af" stroke-width="1"/>
    <text x="640" y="712" class="property-text">+ fromTable: Table [1]</text>
    <text x="640" y="728" class="property-text">+ toTable: Table [1]</text>
    <text x="640" y="744" class="property-text">+ fromColumn: Column [1]</text>
    <text x="640" y="760" class="property-text">+ toColumn: Column [1]</text>
    <text x="640" y="776" class="property-text">+ cardinality: string</text>
  </g>

  <!-- Relationships between SQL classes -->
  <path d="M 250 505 L 330 505" class="relation-line" marker-end="url(#arrow)"/>
  <text x="275" y="495" class="relation-label">hasSchema</text>
  
  <path d="M 550 520 L 630 520" class="relation-line" marker-end="url(#arrow)"/>
  <text x="575" y="510" class="relation-label">contains</text>
  
  <path d="M 870 530 L 950 530" class="relation-line" marker-end="url(#arrow)"/>
  <text x="895" y="520" class="relation-label">hasColumn</text>

  <path d="M 750 610 L 750 650" class="relation-line" marker-end="url(#arrow)"/>
  <text x="760" y="635" class="relation-label">constrains</text>

  <!-- ============ INTEGRATION BRIDGE ============ -->

  <!-- Integration Flow -->
  <g id="integration-flow">
    <rect x="50" y="390" width="1140" height="50" fill="#fef9e7" stroke="#f59e0b" stroke-width="3" rx="8"/>
    <text x="620" y="415" text-anchor="middle" style="font-family: Arial; font-size: 16px; font-weight: bold; fill: #92400e;">
      🔄 Integration Bridge: Business Semantics → SQL Structure
    </text>
    <text x="620" y="430" text-anchor="middle" style="font-family: Arial; font-size: 11px; fill: #451a03;">
      "clients with high premiums" → TableSynonyms + Rules → SQL Query Generation
    </text>
  </g>

  <!-- ============ CONCRETE EXAMPLES ============ -->

  <!-- Business Rule Instance -->
  <g id="rule-instance">
    <rect x="50" y="330" width="240" height="80" class="instance-box" rx="5"/>
    <text x="170" y="350" text-anchor="middle" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #15803d;">&lt;&lt;instance&gt;&gt;</text>
    <text x="170" y="365" text-anchor="middle" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #15803d;">High Value Customer</text>
    <line x1="60" y1="370" x2="280" y2="370" stroke="#16a34a" stroke-width="1"/>
    <text x="70" y="385" style="font-family: Courier New; font-size: 9px; fill: #15803d;">logic: "premium > 5000"</text>
    <text x="70" y="400" style="font-family: Courier New; font-size: 9px; fill: #15803d;">appliesTo: insurance_customers</text>
  </g>

  <!-- Alias Instance -->
  <g id="alias-instance">
    <rect x="950" y="220" width="240" height="60" class="instance-box" rx="5"/>
    <text x="1070" y="240" text-anchor="middle" style="font-family: Arial; font-size: 11px; font-weight: bold; fill: #15803d;">&lt;&lt;instance&gt;&gt;</text>
    <text x="1070" y="255" text-anchor="middle" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #15803d;">"clients"</text>
    <line x1="960" y1="260" x2="1180" y2="260" stroke="#16a34a" stroke-width="1"/>
    <text x="970" y="275" style="font-family: Courier New; font-size: 9px; fill: #15803d;">aliasFor: insurance_customers</text>
  </g>

  <!-- Insurance Customers Table Instance -->
  <g id="customers-instance">
    <rect x="630" y="630" width="240" height="100" class="instance-box" rx="5"/>
    <text x="750" y="650" text-anchor="middle" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #15803d;">&lt;&lt;instance&gt;&gt;</text>
    <text x="750" y="665" text-anchor="middle" style="font-family: Arial; font-size: 13px; font-weight: bold; fill: #15803d;">insurance_customers</text>
    <line x1="640" y1="670" x2="860" y2="670" stroke="#16a34a" stroke-width="1"/>
    <text x="650" y="685" style="font-family: Courier New; font-size: 10px; fill: #15803d;">identifier: "insurance_customers"</text>
    <text x="650" y="700" style="font-family: Courier New; font-size: 10px; fill: #15803d;">rowCount: 60</text>
    <text x="650" y="715" style="font-family: Courier New; font-size: 10px; fill: #15803d;">qualityScore: 78.5</text>
  </g>

  <!-- ============ INTEGRATION RELATIONSHIPS ============ -->

  <!-- Business to SQL Integration Lines -->
  <path d="M 170 240 L 170 390" class="relation-line" marker-end="url(#arrow)" stroke="#dc2626" stroke-width="3"/>
  <text x="180" y="315" class="relation-label" style="fill: #dc2626; font-size: 11px; font-weight: bold;">appliesTo</text>

  <path d="M 750 210 L 750 390" class="relation-line" marker-end="url(#arrow)" stroke="#dc2626" stroke-width="3"/>
  <text x="760" y="300" class="relation-label" style="fill: #dc2626; font-size: 11px; font-weight: bold;">mapsToTable</text>

  <path d="M 1070 190 L 1070 220" class="relation-line" marker-end="url(#arrow)"/>
  
  <!-- Integration bridge to SQL layer -->
  <path d="M 620 440 L 620 450" class="relation-line" marker-end="url(#arrow)" stroke="#f59e0b" stroke-width="4"/>
  <text x="630" y="445" class="relation-label" style="fill: #f59e0b; font-size: 11px; font-weight: bold;">transforms to</text>

  <!-- Instance connections -->
  <path d="M 170 330 L 170 240" stroke="#16a34a" stroke-width="2" stroke-dasharray="3,3" marker-end="url(#arrow)"/>
  <path d="M 1070 280 L 1070 190" stroke="#16a34a" stroke-width="2" stroke-dasharray="3,3" marker-end="url(#arrow)"/>
  <path d="M 750 610 L 750 630" stroke="#16a34a" stroke-width="2" stroke-dasharray="3,3" marker-end="url(#arrow)"/>

  <!-- Legend -->
  <g id="legend">
    <rect x="950" y="750" width="420" height="120" fill="#f9fafb" stroke="#d1d5db" stroke-width="2" rx="5"/>
    <text x="960" y="770" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #111827;">Legend</text>
    
    <rect x="970" y="785" width="50" height="15" class="business-box" rx="2"/>
    <text x="1030" y="795" style="font-family: Arial; font-size: 10px; fill: #374151;">Business Layer (Top)</text>
    
    <rect x="1180" y="785" width="50" height="15" fill="#fef9e7" stroke="#f59e0b" stroke-width="1" rx="2"/>
    <text x="1240" y="795" style="font-family: Arial; font-size: 10px; fill: #374151;">Integration Bridge</text>
    
    <rect x="970" y="805" width="50" height="15" class="class-box" rx="2"/>
    <text x="1030" y="815" style="font-family: Arial; font-size: 10px; fill: #374151;">SQL Layer (Bottom)</text>
    
    <rect x="1180" y="805" width="50" height="15" class="instance-box" rx="2"/>
    <text x="1240" y="815" style="font-family: Arial; font-size: 10px; fill: #374151;">Real Instances</text>
    
    <line x1="970" y1="835" x2="1020" y2="835" stroke="#dc2626" stroke-width="4" marker-end="url(#arrow)"/>
    <text x="1030" y="840" style="font-family: Arial; font-size: 10px; fill: #374151;">Layer Integration</text>
    
    <line x1="1180" y1="835" x2="1230" y2="835" class="inheritance-line" marker-end="url(#inheritance-arrow)"/>
    <text x="1240" y="840" style="font-family: Arial; font-size: 10px; fill: #374151;">Inheritance</text>
    
    <text x="970" y="860" style="font-family: Arial; font-size: 10px; fill: #6b7280;">Clean separation: Business semantics above, SQL structure below, with clear integration paths</text>
  </g>

  <!-- Namespace boxes -->
  <rect x="50" y="750" width="300" height="120" fill="#eff6ff" stroke="#3b82f6" stroke-width="1" rx="3"/>
  <text x="60" y="770" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #1e40af;">Architecture Layers:</text>
  <text x="60" y="790" style="font-family: Arial; font-size: 11px; fill: #6b21a8; font-weight: bold;">🧠 Business Layer (Purple)</text>
  <text x="70" y="805" style="font-family: Arial; font-size: 10px; fill: #374151;">• Natural language terms & business rules</text>
  <text x="60" y="825" style="font-family: Arial; font-size: 11px; fill: #f59e0b; font-weight: bold;">🔄 Integration Bridge (Yellow)</text>
  <text x="70" y="840" style="font-family: Arial; font-size: 10px; fill: #374151;">• Translation layer for Text-to-SQL</text>
  <text x="60" y="860" style="font-family: Arial; font-size: 11px; fill: #1e40af; font-weight: bold;">🏗️ SQL Layer (Blue)</text>
  <text x="70" y="875" style="font-family: Arial; font-size: 10px; fill: #374151;">• Physical database structure & relationships</text>

</svg>